@implements IDisposable

<MudNavMenu>
    <MudNavLink Href="" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Dashboard">
        @GetText("Dashboard")
    </MudNavLink>
    <MudNavLink Href="pos" Icon="@Icons.Material.Filled.PointOfSale">
        @GetText("POS")
    </MudNavLink>
    <MudNavLink Href="orders" Icon="@Icons.Material.Filled.Receipt">
        @GetText("Orders")
    </MudNavLink>
    <MudNavLink Href="reports" Icon="@Icons.Material.Filled.Assessment">
        @GetText("Reports")
    </MudNavLink>
    <AuthorizeView Roles="Manager,SystemAdmin">
        <Authorized>
            <MudNavLink Href="products" Icon="@Icons.Material.Filled.Inventory2">
                @GetText("Products")
            </MudNavLink>
            <MudNavLink Href="categories" Icon="@Icons.Material.Filled.Category">
                @GetText("Categories")
            </MudNavLink>
            <MudNavLink Href="users" Icon="@Icons.Material.Filled.People">
                @GetText("Users")
            </MudNavLink>
            <MudNavLink Href="store-settings" Icon="@Icons.Material.Filled.Settings">
                @GetText("StoreSettings")
            </MudNavLink>
        </Authorized>
    </AuthorizeView>

</MudNavMenu>

@code {
    [Inject] private ILanguageService Lang { get; set; } = default!;
    [Inject] private ILocalizationService L { get; set; } = default!;

    protected override void OnInitialized()
    {
        if (Lang != null)
        {
            Lang.OnLanguageChanged += OnLanguageChanged;
        }
    }

    private string GetText(string key)
    {
        try
        {
            return L?[key] ?? key;
        }
        catch
        {
            return key;
        }
    }

    private void OnLanguageChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        if (Lang != null)
        {
            Lang.OnLanguageChanged -= OnLanguageChanged;
        }
    }
}
